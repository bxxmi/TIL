# 프로젝트 배포 시 서버 통신 에러

* [AWS S3 선택한 이유](#AWS-S3-선택한-이유)
* [서버 통신 에러와 해결 과정](#서버-통신-에러와-해결-과정)

### AWS S3을 선택한 이유

파이널 프로젝트를 배포할 때 9시간을 할애하게 되었다. 평소 Netlify 플랫폼을 통해 간편하게 배포를 해왔기에 이번에도 별 탈 없이 배포가 될거라 예상하고 진행했는데 
서버에 요청을 전혀 보내지 못하는 문제가 발생했다. 이 과정에서 정말 모든 방법을 다 동원했었던 거 같다. 

그러다 개발자도구의 네트워크 탭의 Headers를 다시 꼼꼼히 보았는데 한 가지 의문이 떠올랐다.

```
https 에서 http로 요청을 보낼 수가 있나?
```

우선, 이에 대한 대답은 **NO**라고 한다. 이 생각이 왜 들었냐면 http에서 보안 정책으로 인해 https를 사용하는데 배포된 주소는 https로 시작했고, 우리가 요청을 받아와야하는 주소는 http였기 때문이다.
그렇다면 Netlify에서 배포할 때 http로 변환이 가능한지 궁금해졌다.

찾아보니 Netlify는 https로 고정되어 배포되기 때문에 서버가 없는 **정적 웹 사이트만 호스팅이 가능**하다고 한다. 
AWS S3로 배포하면 http 접속을 https로 리디렉션 시켜줄 수 있다는 것을 알게 돼서 AWS S3를 사용하기로 결정했다.

### 서버 통신 에러와 해결 과정

AWS S3로 배포를 했음에도 여전히 해결되지 않는 문제가 발생했다. 바로 <b>`CORS`</b>와 <b>`pre-flight`</b> 이다.
이번 프로젝트를 진행하면서 수도 없이 봐왔고 백엔드 분들과 해결해왔기에 이 오류를 봤을 때 좌절했다. (왜 또?! 이런 마음이었다🤯)
하지만 우리가 작성한 코드는 거짓말을 하지 않기에 다시 한번 살펴보아야 했다.

우리는 백엔드 분들께 서버를 다시 확인해달라고 요청을 드렸지만, 백엔드 분들께서는 이미 모든 요청에 대한 응답 처리를 하셨다는 답을 주셨다.
따라서, 프론트엔드 측에서 프록시 설정을 해보았지만 전혀 해결되지 않았다.

천천히 네트워크 탭의 Headers를 보았고, 무언가 잘못된 점을 발견했다.
요청하는 주소에 대한 처리가 연관된 **`access-control-allow-origin`** 부분이 애스터리스크가 아닌 배포 주소로 적혀있었기 때문이다. 

백엔드 분들께 말씀드리고 관련 정보를 공유한 끝에 잘 해결이 됐고, 프론트엔드와 백엔드 모두 서버 통신 에러가 난 경우 
어떤걸 시도해보고 무엇을 확인해보는지 정확하게 알 수 있는 계기가 되었다.

